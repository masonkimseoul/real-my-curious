# 무결성 제약조건, 키, 관계대수, 뷰, 인덱스

### 릴레이션

- 관계형 데이터베이스에서 `테이블`을 의미한다.

### 튜플

- 테이블의 한 행
- 릴레이션 내에서 데이터의 각 레코드 ➡️ 각 속성의 값을 포함한다.

# 무결성 제약조건(Integrity Constraint)

- 데이터베이스의 정확성과 일관성을 보장하기 위해 설정되는 조건
- 데이터의 저장, 삭제, 수정 등을 제한하거나 조절하는 역할
- 데이터베이스의 상태를 일관되게 유지하고 데이터의 무결성을 보장한다.

## 무결성

- 데이터베이스에서 데이터의 정확성, 일관성을 유지하는 것
- 데이터에 결함이 없는 상태

### 개체 무결성

- == 기본키 제약
- 기본키는 널값을 가질 수 없다.
- 기본키는 항상 `유일`하고 비어 있을 수 없는 값이어야 한다.

### 참조 무결성

- == 외래키 제약조건
- 외래키 값은 널이거나 참조하는 릴레이션의 기본키 값과 동일해야 한다.
- 각 릴레이션은 참조할 수 없는 외래키 값을 가질 수 없다.

### 도메인 무결성

- == 도메인 제약
- 각 속성들의 값은 정의된 도메인에 지정된 값만을 가져야 한다.
- `작성일`에 날짜 데이터가 아닌 다른 데이터가 들어간다면 도메인 무결성 제약조건을 위반한 것이다.

### 고유 무결성

- 특정 속성에 대해 고유한 값을 가지도록 조건이 주어진 경우, 릴레이션의 각 튜플이 가지는 속성 값들은 고유한 값을 가져야 한다.

### NULL 무결성

- 릴레이션의 특정 속성 값은 널이 될 수 없다.

### 키 무결성

- 각 릴레이션은 최소한 한 개 이상의 키를 가져야 한다.
- 키는 튜플을 식별할 수 있는 값이어야 한다

## DBMS의 무결성 제약조건 유지

### INSERT(삽입)

- 무결성 제약조건을 위배하는 삽입 연산은 DBMS가 거절한다.

### DELETE(삭제)

- 참조되는 릴레이션은 참조 무결성 제약조건을 위배할 수 있다.

#### 옵션

- 제한(restricted) : 위배를 일으킬 수 있는 삭제 연산은 거절한다.
- 연쇄(cascade) : 참조되는 릴레이션에서 튜플을 삭제하고, 참조하는 릴레이션에서 이 튜플을 참조하는 튜플도 다 삭제한다.
- 널값(nullify) : 참조되는 릴레이션에서 튜플을 삭제하고, 참조하는 릴레이션에서 이 튜플을 참조하는 튜플들의 외래키에 널값을 넣는다.
- 디폴트값 : 참조되는 릴레이션에서 튜플을 삭제하고, 참조하는 릴레이션에서 이 튜플을 참조하는 튜플들의 외래키에 default 값을 넣는다.

### UPDATE(수정)

- 기본키, 외래키 수정시 DELETE 옵션과 같은 방식이 적용된다.
- 기본키나 외래키 이외의 값을 수정하는 경우 참조 무결성 제약조건 외 나머지 제약조건을 만족하는지 검사한다.

## 제약조건 정의

- 릴레이션 정의 시 다양한 제약조건을 추가할 수 있다.
- NOT NULL
- UNIQUE
- DEFAULT
- CHECK : 한 애트리뷰트가 가질 수 있는 값의 범위를 지정한다.

# 키

### 유일성

- 하나의 키 값으로 튜플을 유일하게 식별할 수 있는 성질

### 최소성

- 키를 구성하는 속성들 중 가장 최소로 필요한 속성들로만 키를 구성하는 성질

## 키의 역할

1. 레코드 구분
2. 무결성 제약조건 보장
3. 레코드 검색 및 정렬
4. 관계형 데이터베이스에서 레코드 연결
5. 인덱스 생성 및 검색
6. 데이터의 보안 유지
   접근할 수 있는 사용자를 제한하거나 암호화된 키를 사용할 수 있다.

## 슈퍼키

- `유일성`을 만족하는 키
- 어떤 속성끼리 묶던 중복값이 안나오고 서로 구별만 할 수 있으면 된다.

## 복합키

- `2개 이상`의 애트리뷰트를 사용한 키

## 후보키

- `유일성`과 `최소성`을 만족하는 키
- 기본키가 될 수 있는 후보

## 기본키

- 후보키에서 선택된 키
- NULL값이 들어갈 수 없다.
- 기본키로 선택된 애트리뷰트는 유일해야 한다.
- 릴레이션에서 오직 1개만 지정할 수 있다.

## 대체키

- 후보키 중에 기본키로 선택되지 않은 키

## 외래키

- 어떤 릴레이션 간의 기본키를 참조하는 속성
- 릴레이션들 간의 관계를 나타내기 위해서 사용된다.
- 참조될 열의 값은 참조될 릴레이션에서 기본키로 설정되어 있어야 한다.

# 관계 대수

- 관계형 데이터베이스 내에서 원하는 정보를 어떻게 찾아낼 수 있는가를 기술하는 절차적인 언어
- DBMS 내부의 처리 언어로 사용된다.
- 피연산자 : 릴레이션
- 연산자 : 셀렉션, 프로젝션, 디비전 등 수학의 집합 개념에 기초한 연산자

## 관계대수 연산자

### `1` 셀렉션(Selection)

- σ
- 릴레이션에서 조건에 부합하는 `튜플을 추출`한다.
- 릴레이션의 차수(애트리뷰트 수)는 동일하고 카디날리티(특정 데이터 집합의 유니크한 값의 개수)는 작거나 같다.
- ∧(and) ∨(or) ￢(not) 와 같은 기호로 여러 개의 조건 지정 가능

### `2` 프로젝션(Projection)

- π
- 조건에 부합하는 릴레이션의 `속성을 추출`한다.
- 릴레이션의 차수는 작거나 같고 카디날리티는 동일하다.

### `3` 합집합(Union)

- ∪
- 두 릴레이션을 합한다.
- 두 릴레이션은 서로 같은

### `4` 교집합

- ∩
- 교집합의 대상 릴레이션은 서로 같은 속성 순서와 도메인을 가져야 한다. : 합병가능한 상태

### `5` 차집합

- ㅡ

### `6` 카디전 프로덕트

- ×
- 수평 연산, 두 개의 릴레이션을 하나로 합칠 때 사용한다.
- A의 릴레이션에서 오른쪽에 B릴레이션의 모든 튜플을 순서대로 배열한 형태가 된다.
- `A의 차수 + B의 차수`
- `A의 카디날리티 x B의 카디날리티`

### `7` 조인

- 유도된 연산자
- 카티전 프로덕트와 셀렉션 연산을 함께 실행하여 얻은 결과와 동일하다.
- 조인에 참여하는 속성은 서로 동일한 도메인으로 구성되어야 한다.

| 이름                                           | 기호      | 기능                                                                                                                          |
| ---------------------------------------------- | --------- | ----------------------------------------------------------------------------------------------------------------------------- |
| 동등조인                                       | ⋈         | 두 릴레이션 간의 같은 값을 가진 집합                                                                                          |
| 세타조인                                       | ⋈θ        | 두 릴레이션 간의 비교 조건에 만족하는 집합                                                                                    |
| 자연조인                                       | ⋈N        | 동등조인에서 중복 속성을 제거                                                                                                 |
| 세미조인                                       | ⋉         | 자연조인 후 기호의 열린쪽의 속성을 제거                                                                                       |
| 외부조인 Left / 외부조인 Right / 외부조인 Full | ⟕ / ⟖ / ⟗ | - 자연조인 후 각가 왼쪽, 오른쪽, 양쪽의 모든 값을 결과로 추출한다.<br />- 조인이 실패 또는 값이 없을 경우 한 쪽의 앖을 NULL로 |

### `8` 디비전

- ÷
- 디비전은 릴레이션의 속성 값의 집합으로 연산을 수행한다.

# 뷰(View)

- 사용자에게 접근이 허용된 자료만을 제한적으로 보여주기 위해 하나 이상의 기본 테이블로부터 유도된, 이름을 가지는 가상 테이블
- 저장장치 내에 물리적으로 존재하지 않지만 사용자에게 있는 것처럼 간주된다.
- 데이터 보정작업, 처리과정 시험 등 임시적인 작업을 위한 용도로 활용된다.
- 조인문의 사용 최소화로 사용상의 편의성을 최대화한다.

## 장점

1. 논리적 데이터 독립성을 제공한다.
2. 동일한 데이터에 대해 동시에 여러 사용자의 상이한 응용이나 요구를 지원해준다.
3. 사용자의 데이터 관리를 간단하게 해준다.
4. 접근 제어를 통한 자동 보안이 제공된다.

## 단점

1. 독립적인 인덱스를 가질 수 없다.
2. ALERT VIEW문을 사용할 수 없다. ➡️ 뷰의 정의를 변경할 수 없다.
3. 뷰로 구성된 내용에 대한 삽입, 삭제, 갱신, 연산에 제약이 따른다.

## VIEW 정의

```sql
CREATE VIEW 뷰이름[(속성이름[, 속성이름)]] AS SELECT문;
```

## VIEW 삭제

```sql
DROP VIEW 뷰이름 RESTRICT or CASCADE
```

# 인덱스

- 추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블에 저장된 데이터의 검색 속도를 향상시키기 위한 자료구조
- 책의 목차와 색인 같은 역할을 한다.
- 데이터를 검색할 때 전체 테이블을 스캔하는 것이 아니라 인덱스를 사용하여 검색 대상 레코드의 범위를 줄일 수 있다.
- 대량의 데이터를 다루는 경우 데이터 검색 속도를 크게 향상시킨다.

## 장점

1. 검색 대상 레코드의 범위를 줄인다 ➡️ 검색 속도를 빠르게 할 수 있다.
2. 중복 데이터를 방지하거나 특정 컬럼의 유일성을 보장할 수 있다.

## 단점

1. 인덱스 생성에 따른 추가적인 저장 공간 필요
2. 삽입, 삭제, 수정 작업 시에도 인덱스 업데이트해야 함
3. 인덱스 생성 시간이 오래 걸릴 수 있다.
